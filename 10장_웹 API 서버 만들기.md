---


---

<h1 id="api-서버-이해하기">10.1 API 서버 이해하기</h1>
<p>API는 Application Programming Interface의 약자로, 다른 애플리케이션에서 현재 프로그램의 기능을 사용할 수 있게 허용하는 접점을 의미한다.<br>
API 서버는 프런트엔드와 분리되어 운영되므로 모바일 서버로도 사용할 수 있다. 노드를 모바일 서버로 사용하려면, 서버를 REST API구조로 구성하면 된다. 특히 JWT토큰은 모바일 앱과 노드 서버 간에 사용자 인증을 구현할 때 자주 사용된다.</p>
<p>웹 API는 다른 웹 서버스의 기능을 사용하거나, 리소스를 가져올 수 있는 창구이다. 흔히 API를 열었다, 혹은 만들었다고 표현하는데, 이는 다른 프로그램에서 현재 기능을 사용할 수 있게 허용하였음을 뜻한다. 다른 사람에게 제공하고 싶은 부분만 API를 열어놓고, 제공하고 싶지 않은 부분은 API를 만들지 않는다. 또한 API를 열어 놓았다 하더라도, 인증된 사람만 제한된 횟수 내에서 자원을 가져가게 할 수도 있다.</p>
<p>위와 같은 서버에 API를 올려서 URL을 통해 접근할 수 있게 만든 것을 웹 API서버라고 한다.</p>
<h3 id="크롤링">크롤링</h3>
<p>웹 사이트가 자체적으로 제공하는 API가 없거나, API이용에 제한이 있을 때 표면적으로 보이는 웹 사이트의 정보를 수집해 자체적으로 가공하는 것</p>
<h1 id="jwt-토큰으로-인증하기">10.3 JWT 토큰으로 인증하기</h1>
<p>JWT는 JSON Web Token의 약어로, JSON 형식의 데이터를 저장하는 토큰이다.<br>
JWT는 다음과 같이 세 부분으로 이루어져 있다.</p>
<ul>
<li>헤더: 토큰의 종류와 해시 알고리즘 정보가 들어 있다</li>
<li>페이로드: 토큰의 내용물이 인코딩된 부분이다.</li>
<li>시그니쳐: 일련의 문자열로, 시그니처를 통해 토큰이 변조되어있는지 여부를 확인할 수 있다.</li>
</ul>
<p>JWT 토큰은 보통 JWT비밀키를 알지 않는 이상 변조가 불가능하다.<br>
변조한 토큰은 시그니처를 검색할 때 파악할 수 있다.<br>
따라서, 변조할 수 없으므로 내용이 바뀌는 걱정을 하지 않아도 되므로, 외부에 노출되어도 좋은 정보에 한해 정보를 안심하고 저장할 수 있다.<br>
단점은 용량이 크다.<br>
매 요청시 토큰이 오고 가기 때문에 데이터 양이 증가한다.</p>
<h1 id="cors-이해하기">10.7 CORS 이해하기</h1>
<p>클라이언트에서 서버로 요청을 보낼 때는, 클라이언트와 서버의 도메인이 일치하지 않으면 기본적으로 요청이 차단된다.<br>
서버의 도메인이 달라 발생하는 문제를 CORS(Cross-Origin Resource Sharing)이라고 한다.</p>
<p>이 CORS 문제를 해결하기 위해서는 응답 헤더에 Allow-Control-Allow-Origin이라는 헤더를 넣어 주어야 한다. cors 패키지를 사용하면 쉽게 해결할 수 있다.</p>
<pre><code>npm i cors
</code></pre>
<pre><code>nodebird-api/routes/v2.js
... //사용 미들웨어 선언부
const cors = require('cors')
...
router.use(cors());
</code></pre>
<p>를 추가하기만 하면 이 문제를 해결할 수 있다.</p>
<p>여기서 문제는, 요청을 보내는 주체가 클라이언트여서(xhr.send(’#{key}’)),<br>
비밀키가 모두에게 노출되므로, 이 비밀 키를 가지고 다른 도메인들이 APU서버에 요청을 보낼 수 있게 된다.<br>
이를 해결하기 위해서는, 처음에 비밀 키 발급 시 허용한 도메인을 적게 하고, 호스트와 비밀키가 모두 일치할 때만 CORS를 허용하게 수정하면 된다.</p>
<blockquote>
<p>nodebird-api/routes/v2.js</p>
</blockquote>
<p>cors를 호출할 때 객체를 만들어 옵션 인자를 준다.<br>
옵션 인자의 origin속성에 허용할 도메인만 따로 적어두면 그 도메인의 요청만 허용한다.</p>

